> #Lab 12 startscript for the OLS exercise. 
> library(data.table)
> df.OLSdat <- read.table("OLSqData.RData")
> DT <- data.table(df.OLSdat) 
> summary(df.OLSdat)
       y1              const         x1                  x2                  x3                eps1         
 Min.   :-9.9702   Min.   :1   Min.   :-1.133716   Min.   :-3.495955   Min.   :-3.62815   Min.   :-5.55084  
 1st Qu.:-0.2355   1st Qu.:1   1st Qu.:-0.215853   1st Qu.:-0.660744   1st Qu.:-0.69209   1st Qu.:-0.89483  
 Median : 2.1326   Median :1   Median :-0.001969   Median : 0.016092   Median :-0.01991   Median : 0.05169  
 Mean   : 2.1315   Mean   :1   Mean   :-0.002308   Mean   : 0.005896   Mean   :-0.01103   Mean   : 0.04178  
 3rd Qu.: 4.5539   3rd Qu.:1   3rd Qu.: 0.206096   3rd Qu.: 0.675900   3rd Qu.: 0.65831   3rd Qu.: 0.98693  
 Max.   :14.2907   Max.   :1   Max.   : 1.272602   Max.   : 4.019762   Max.   : 3.59055   Max.   : 5.51511  
      eps2         
 Min.   :-51.8292  
 1st Qu.: -9.3422  
 Median : -0.3710  
 Mean   : -0.1252  
 3rd Qu.:  9.3672  
 Max.   : 51.5583  
> summary(DT)
       y1              const         x1                  x2                  x3                eps1         
 Min.   :-9.9702   Min.   :1   Min.   :-1.133716   Min.   :-3.495955   Min.   :-3.62815   Min.   :-5.55084  
 1st Qu.:-0.2355   1st Qu.:1   1st Qu.:-0.215853   1st Qu.:-0.660744   1st Qu.:-0.69209   1st Qu.:-0.89483  
 Median : 2.1326   Median :1   Median :-0.001969   Median : 0.016092   Median :-0.01991   Median : 0.05169  
 Mean   : 2.1315   Mean   :1   Mean   :-0.002308   Mean   : 0.005896   Mean   :-0.01103   Mean   : 0.04178  
 3rd Qu.: 4.5539   3rd Qu.:1   3rd Qu.: 0.206096   3rd Qu.: 0.675900   3rd Qu.: 0.65831   3rd Qu.: 0.98693  
 Max.   :14.2907   Max.   :1   Max.   : 1.272602   Max.   : 4.019762   Max.   : 3.59055   Max.   : 5.51511  
      eps2         
 Min.   :-51.8292  
 1st Qu.: -9.3422  
 Median : -0.3710  
 Mean   : -0.1252  
 3rd Qu.:  9.3672  
 Max.   : 51.5583  
> #vs. DT$y1
> DT$y1
   [1]  7.71412793  1.56656494  2.96812978  6.97420765 -0.28444722 -1.07400520 -0.32080337  3.25682360  6.82007075
  [10]  2.53664321  5.76142488  4.18688904 -2.59195994  0.97670193  1.77745722  0.68596458  6.19469477  2.74560489
  [19] -2.84595759  0.27556392  4.28061750  1.59371325  2.86056001  2.69183919  6.52754138  6.84171560 -2.02583082
  [28]  2.92053206  0.35652582 -0.66157859 -1.37771049  3.16913425 -0.28334992  4.15253239  0.18038552  3.35121520
  [37]  5.03290076 -0.31351163  6.16427763  0.23782859  1.31489271  7.55583924  0.25113734  0.87947766  2.90333212
  [46]  5.71194599  2.47035095  3.96671163 -2.29906504  0.69301471  0.15021098  1.46393223  2.05816226 -0.03926841
  [55]  0.44975984  5.51897587 -1.27165519  2.81680518  1.57916719  5.86993898  8.63237332 -2.47875636  4.23798375
  [64]  5.20311323  7.08568121 10.07398664 -2.90349602  1.63053357  5.57049579 -6.96977020  1.94892056  0.94513355
  [73]  3.16673672  7.54018988  5.36158115  2.19133041  1.29671971  5.58794040  3.08964791  2.33132165 -0.13692037
  [82]  2.03840776  4.61961132 -1.18940406  0.27286821  3.07479382  0.50228920  0.74122654  4.88236112  0.70529636
  [91] -0.24356516  0.97294059 -2.79272317  6.09697367  4.52789325  4.89528766  2.11704606  0.62026117  3.20328792
 [100] -3.99385348  3.89969864  1.02436048  0.57187587  3.44867254 -1.39884084  0.26495778  4.41053458 -7.36988156
 [109]  3.60660286  6.95427450  0.93546716  5.00626138  2.64997560  3.60110641  3.20002327  5.33062078 -0.36717369
 [118]  4.89140790 -0.34437262  6.48237000  6.19378337 -5.26094594 -1.28962184 -1.45732998 -0.89970882  3.03482432
 [127]  2.03288557 -1.53616706  1.31214585 -2.59769241  1.42733543  5.00929085  0.41187627  0.85986224  8.38131813
 [136]  1.31707767  0.38944047  4.37107153  1.89651245 -2.72838034  1.20436892 -1.22383295 -1.44903457  5.36367889
 [145]  0.73394053  0.92962585 -0.07461052  4.32620168 -1.09872598  1.22306300 -7.05992599  9.04045248 -0.03765005
 [154] -0.56155236 -5.52229657  2.73186982  4.03595688 -7.33307486 -2.46608355  4.88862942  2.07806188 -1.50504425
 [163]  6.46414123  0.66801183  0.02171385 -1.21586993  1.05854313 10.25832769 -2.99006951 -4.06167636  1.70525695
 [172]  0.62736676 -3.35783365  3.17048995  0.96883254  0.90264084  1.16211814  3.08497771  6.63822147 -0.27027336
 [181] -1.90739635  2.41299125 -2.85761373  2.54064840  6.48780874  2.03930256  2.23571348  4.06375021  2.24673025
 [190]  0.67225362  4.34297822  1.06461952 -0.31219964 -1.14090380  0.74148237  6.94977162 -0.06395884 -1.67260130
 [199] -0.11411074 -1.30130799  6.86507939 -1.04807500  4.58670918  4.32750249  5.60082196  3.34224079  2.35797417
 [208]  3.61194173 -1.68848914  3.41114840 -9.71174809  2.55522115  7.78844822  2.19251259 -4.12124031  0.78978061
 [217] -1.20731055  5.64371253  6.49338387  7.63704039  1.60618674  9.46183683 -5.04893810 -4.96918149  0.72434266
 [226]  4.09151335  0.80983306 -1.92539927 -1.77246843  8.87461436  4.27610494  3.54503459  3.45599570 -0.47086596
 [235]  6.22831728  5.43121361  0.31855619  7.74297599  3.86240316  5.75858662  1.56486724  2.91843228  7.75566379
 [244]  3.72814192  3.70936416  2.14880163  1.86150259  8.30936546 -0.30234446  5.23607594  3.31411712  2.34780803
 [253]  2.89238868 -0.27880339  7.40703075  0.26421358 -1.75253622 -4.35491141 -0.60423078  3.57982039  6.17918263
 [262]  1.25293276  6.76021659  2.25455249  0.12980583  0.58887785 -2.56163864  4.37048794  3.40117723  7.44396413
 [271] -1.32577787 -0.07682548  0.74635143  2.37864074  1.20427305  5.04855594  4.55375384  3.58162584  1.18886073
 [280]  4.53506654  2.41943992  2.41042750  3.93634365  3.80967600  1.81291569  0.37250307 -0.17307710  1.47687793
 [289]  6.56159526 -4.41775919  3.40469809  1.05734194  3.10553078  0.05177361 -2.25911836 -2.17138522  2.75411830
 [298]  3.95655135  5.54167188  0.73910942  5.37425794 -6.41442587 -0.69797642  6.20481362  2.65096317  3.11075513
 [307]  2.29893676  6.67853254 -1.95840455 -1.12062133  3.63173639  1.84933482  5.39108839  2.82668366  0.23059850
 [316]  3.82908622 -3.47028395  4.44078071  4.09619431 -2.24206931  2.26184626  1.51835571  5.49157229  5.26077300
 [325]  1.24375710  1.98763744  5.22110565  1.81181782  3.21075416  1.45939604 -2.79735297 -0.36691573  3.14767688
 [334] -0.34174064  0.02767328  0.48818397  1.89893481  5.74882560  4.92357833 -2.86304403  1.65853084 -1.04821729
 [343]  0.71473323 -3.95303528 -4.71953430 -2.40803088 -1.16703046  4.77002449  2.49726606 -1.67750819  2.82024882
 [352]  4.41487359  3.13338837 -6.52819509 -4.71599387 -1.52376208 -4.26370672  1.61533296  0.17372593  2.65303429
 [361]  6.39421599  2.80504446  5.52296968  3.54005919  5.75006829  8.31309450 -2.73545908  4.84449397  0.06178733
 [370] -4.42327532  3.91854287  2.20113381  9.94008482  5.12843485  3.39579868  3.58807621  1.38641559 -3.35460629
 [379] -3.76594884  3.67066675  6.03848347 -1.39838587  0.65810897  1.52965701  3.30097479  1.86462080  3.07754943
 [388]  5.21601395  1.37045138  7.20458722 -3.44340536  6.44258637  3.55746689  0.34302563  4.34841303  0.27121115
 [397] -3.29228654  0.75247369  0.49507413  0.65591594  7.21471992  6.11492096  0.91629259  1.29711702  1.55272668
 [406]  2.24810442  2.64611453  3.27506158  4.56082380 -2.20554959  3.37715438 -1.46399850 -4.01066371  3.44289561
 [415] -3.14213779 -4.45715995  3.08064654  4.65424776  5.39374392 -0.74803286  7.75416360 -0.15736254  3.33558441
 [424]  0.44053819  2.55299545  2.42260687  8.26672601  0.57208473  3.38179240  3.08190061 12.76669611 -0.16696082
 [433] -5.87400693  4.76315688  4.49576719  1.60279344  2.86591164  1.14248718 -2.11203113 -2.41639667  5.33235972
 [442]  8.57971390  3.63082530  1.21469257  4.50305304  0.22595576  7.45048062 -4.32051067  1.54301236  6.16307628
 [451]  4.40877078 -0.26075361 -3.73770736 -1.36015422  7.37006564  2.18522534  4.17456037 -0.27876335 -2.96845539
 [460]  4.27891017  0.92589909  3.66349425 -3.28785887  4.77281400 -4.08497325 -2.11984132  3.24703745  8.05265081
 [469]  1.84472501  1.91245870  2.91291347  2.83812843  3.69479534  7.38819320  0.09466579  3.25286071  4.16992751
 [478]  2.81929940 -6.20438470 -4.42289504  2.64610107  0.39103113 -3.67185361  2.12521535  1.71826881  6.97911864
 [487]  0.81129772  7.55807139  3.99074465  6.97602810  2.24362046  0.48858460  5.75495876 -0.58448321  2.09331043
 [496]  0.06505111  3.53280057  0.05854661  4.50432622  6.12466280  0.70382534  6.41014568 -0.23602722 -0.48412016
 [505]  6.77176874  4.06990183 -0.14911866  1.08420001  2.51030357  2.65987617  4.30105605  4.28646439  2.38199902
 [514] -0.97111493 -0.10929716  1.73555367  1.71903036  2.09282243  5.31835120  4.77362861 -1.80678802  1.02717474
 [523]  4.06419692  1.32585716  0.60441795  4.02149289 12.59318309 -0.40547445 -2.37763349  6.90473843  1.44876903
 [532]  1.83390677  4.64533732 -1.82569192  2.74886724  1.04875020 -0.57022627  3.05935793  5.85311700  2.31380070
 [541]  3.06598672 -0.09230123  1.69796184  4.48056874  0.62113820  0.20592839  1.27133879  1.08047206  3.68059971
 [550]  2.85346678 -0.85316986  3.53129902  4.42629530  0.88264659  6.70017354  4.39778805  1.69771296 -3.08448638
 [559] -9.19402807  2.44169551  4.56061654  1.39374652 -0.19502329  4.85094755  1.91916529 -2.39780850  2.93850508
 [568]  3.00417795  3.36816896  3.34046515  0.67973314  1.03726899  4.92915609  0.99660282  2.25819456  1.56784371
 [577]  6.96896243  2.80224719  3.10463511  6.31651986 -1.25928411  5.99189811  3.25928335  3.85651059  4.40962193
 [586]  3.10161854  6.90810648  6.43341008  1.38235041  0.20270849  1.51355345  3.92880071  3.04752752  1.04436883
 [595]  0.26114260  2.25446054  3.98879339  1.71710001  5.86333564 -3.86167281 -0.70392227  0.35457762 -2.71077046
 [604]  2.28297245  5.57859105 -0.04042143  1.20368087 -0.87350193  4.27864302  5.37861359  0.71244950 -1.74198048
 [613] -3.77201449  1.24532859  4.54160297  7.48095717  2.22477731  0.97639197  0.04491494  5.29614602  6.61841754
 [622]  3.95186619 -1.21858366  4.49048996  0.88974590 -0.80843085 -0.17323241  5.07821273  4.28416743  5.96127448
 [631]  2.12380599 -2.45374493 -1.52529949  5.80708453  1.99764655  6.45796238  0.35299264  1.53473842  1.02466367
 [640]  0.62204525  2.56003177  0.63721394  8.55907710  7.23639996  2.11077300  4.70770411 -4.18287084  1.07259438
 [649]  0.31466115 -0.85279301  1.91448990 -0.53089010 11.99810932  3.69151593 -0.90035537  4.77535900  6.77299309
 [658]  4.53304893  0.13500449 -3.77608026 -3.52440542  2.75093280 -1.15829302 -2.79426356  4.12147019  0.83373403
 [667]  1.82755325 -3.26548153  5.04852784 -0.33491418 10.31715417 -4.56120650  1.97105171  2.56443530  4.02156534
 [676]  7.20023604  5.00899138  3.20442806  1.70628852 -0.58788388  4.04410587  2.74418777 -0.62803239 -0.25444115
 [685]  4.30693602  4.29537823 -0.51847205 -3.90536150 -0.54103518  9.20727030  0.50844282  5.17454510  2.79036164
 [694] -4.12881584  3.92184581 -0.20678714  0.58757869  6.16734335  4.89556366  3.31040916 -1.65220445 -3.38457525
 [703]  5.54535387  8.84470371  0.49921027  5.19161260 11.81781790 -1.43023029  6.61870500  5.14280456  6.28473342
 [712]  3.05479888 -0.75066108  4.77702361  5.19530034  0.57703415  3.03480300  3.73236862  2.54312654  5.16956496
 [721] -2.82573251  5.37589105 -2.25557849 -0.49831001  6.44925456 -0.66211258  4.24691653  3.12722381  2.05601886
 [730] -0.38970995 -1.22961722 -2.70893000  0.43282743  6.30446190  3.08584027  1.34094466  1.69240936  3.38335813
 [739]  4.07113108  1.12015796 -1.13341952 -0.05144283  5.43680500 -0.20906551 -4.80442475 -3.17150926  5.73771889
 [748]  4.59662163 -1.23860481  4.87545217 -1.65071202  2.74943360 -3.03150234  5.51238439  2.89117363  8.52570679
 [757]  2.79039088  7.44127640 -4.75761999  0.01270610  0.04095600  0.43231398  0.27381623  9.75657352  3.55628706
 [766]  3.27306343 -3.95741664  0.20785098  7.55708665  1.77050789  5.85041549 -4.89271547  5.82014929  1.03722378
 [775]  1.90922769 -5.31762939  9.59816492  1.18225273  5.40512600  7.76243300 -3.84729069  3.19410885  7.27747795
 [784] -3.76324887 -1.85738172  4.73949867 -0.25081033  3.40147584  3.02661839  4.27841172  1.56878430  1.55524247
 [793]  5.03121508  2.21078958  2.91101405  5.98354772  2.83288555 -0.98084134  6.97440110  5.31210312  2.42756990
 [802]  3.08105034  1.59818594 -0.75939986  4.19779711 -1.57323529  0.51608781  0.50221760 -1.70177985  1.13238082
 [811]  2.25769439 -2.62884116 -1.96045758 -0.90183924  2.90537788  7.26199662  3.78812514 -2.78665065  3.19130418
 [820]  5.87031745  4.45498774 -3.55856243  7.80941851  2.87088974  3.95856705  2.03866866 -1.37797177 -1.64822558
 [829] -1.95293539  0.47404201 -1.68127537 -4.22635788  5.28200473  2.80172626 -2.74665032  2.54978414  3.77601147
 [838]  1.08085810 -0.31011354  0.33350292  1.41545413  1.66419557 -6.62209788  4.52920523 -0.93070491  2.21372714
 [847] -3.19419284 -1.98316539 12.82681692  5.05812735  3.40756464  2.00323042  6.35884764  4.02407039  2.16860573
 [856]  5.70709417  0.42674903  4.10009401  2.30710399  4.37169141 -1.32385928  3.53364282  7.28161145 -2.85605330
 [865]  0.43007995  1.74059777 -0.05129830 -0.07806304  1.33966964  0.85585385  3.58165146  2.05566606  1.72090987
 [874]  0.59160176  4.14285944  3.08941886  2.50185765  5.35491499  0.83282851  2.38081525 -4.82666170 -4.16727238
 [883]  2.65603277  2.66534861  0.46691776 -4.22984266  0.60886820  6.22825947  2.36737806 -1.15463194  7.14687810
 [892]  2.38691310  6.00469288  5.42792821  0.88641760  4.77403038  3.41988735  4.45140764 -4.98696749 -1.23535544
 [901]  4.01594678  2.42087040  2.79952905 -5.72904787  5.97209540  5.98729861  0.80359939  6.38405561  8.48896201
 [910] -0.71943218  2.98280895  1.51892043  1.95899254  4.66530593 -2.58283055  6.54435368 -1.17689553  9.16245177
 [919]  6.11538823 -1.00252876  3.47571910 -0.81698110  7.06156561  1.36972178  4.81043105 -0.65135000  3.20829747
 [928] -0.48583947  0.87885516  1.22558558 -0.50123933 -1.44759407 -5.07900532  0.78819481 -4.30925454 -1.85941094
 [937]  9.55269644  1.54759039  1.40943631 -2.15366780  4.88177304  6.45137360  5.49665691  0.05795515  5.97673744
 [946]  6.14518748  4.39402761  4.94990016  4.77595926 -5.70005084  4.37152392 -0.76221655 -1.47815196 -2.37575448
 [955]  9.65471908  2.90751300 -3.19363234 -0.34659739  0.82989333 -2.03939109  2.09823766 -5.19438144  2.00509135
 [964]  4.92118188  1.65500046  5.67199022  2.77278713 -0.76871992  3.99510220  3.23958208  2.98192032  2.38952187
 [973] -5.70527505  6.64547696  2.68394068  2.58442295  2.42953627  1.94214921  3.84570991  5.17337798 -2.11305589
 [982]  3.92288096 -6.84273449  0.41923603  1.95601699  1.85247551 -0.77219693  4.80643574  0.05905459  2.88381048
 [991] -2.97014235  2.68208925  0.69743044  2.23765864  5.21836989  1.13268150 -0.71171902  2.95649449  0.56908744
[1000]  3.29336490
 [ reached getOption("max.print") -- omitted 6584 entries ]
> #Try for x1
> DT$x1
   [1] -0.4202375884 -0.3687473730 -0.2957717771 -0.4000175159  0.8215654936 -0.0483358917 -0.0704548437
   [8] -0.0376357574 -0.2278456640  0.1112286776  0.1792931515 -0.2586829830  0.0755454606 -0.1419916902
  [15] -0.1566378719  0.0834228745  0.2087577246 -0.3652724895  0.1119740347 -0.5951418598 -0.0730088929
  [22] -0.0027347710 -0.2261179291  0.0829642149 -0.3244195927  0.5556363627 -0.4299500359  0.0436529690
  [29] -0.2737902727 -0.4011537854 -0.7182564039 -0.2784171189 -0.3491123383 -0.2707416981 -0.3296380842
  [36] -0.0462195407  0.1485620100 -0.0476227330 -0.0082085879  0.5517305697  0.2563566326  0.2955243557
  [43]  0.0849010573 -0.1125817678  0.0742821815  0.0325261580  0.1054892394  0.0172866857  0.1161719726
  [50]  0.0640317983 -0.5248681867 -0.2589550014 -0.0391311385  0.4673181947 -0.5836744454  0.3074294753
  [57]  0.0214747600 -0.2568993746 -0.0314074960 -0.0744183217  0.2612843984  0.0570183296 -0.1100481467
  [64] -0.1012815226  0.3876253499  0.1259963041  0.1574520110 -0.1043424798  0.2607681414 -0.1510320060
  [71] -0.0517157790 -0.2838972273  0.2237780740 -0.1769072911 -0.0764849100 -0.1323080675 -0.1407796938
  [78]  0.1290813685 -0.2415302089  0.2348958604 -0.2244597271 -0.0213360437 -0.0200926673  0.5935359424
  [85]  0.4025143510 -0.0047919225 -0.0318625263  0.2804278272  0.0112089495  0.2257555774 -0.1690185879
  [92]  0.3521176867  0.2212051692  0.0694277709 -0.0253597529  0.0542308207 -0.0280371310  0.1612081043
  [99]  0.4360454988  0.1498564202  0.3273433241 -0.4092966882  0.7107101985 -0.3666080188 -0.0113794967
 [106] -0.6705318516 -0.2081397275 -0.2358699517  0.5878983956  0.3685184290  0.3242389746 -0.2371546621
 [113] -0.1190821133  0.3016416054 -0.2158235303 -0.0624375431 -0.3002125812  0.3631178944 -0.1844343812
 [120]  0.1712660889  0.2746975133 -0.2602988099 -0.1574909260  0.1720411677  0.0732928670 -0.2941613461
 [127] -0.1444057298 -0.4061209546 -0.6995078064 -0.3693582974 -0.0336259269 -0.2040044662  0.0418674386
 [134]  0.0130865851 -0.2194013383 -0.2159412027  0.0693826793 -0.5112509339 -0.2141510411 -0.2024939466
 [141]  0.0584299278  0.4177559076 -0.3276933427 -0.0675240541  0.1756704644  0.1879959205 -0.2413065827
 [148] -0.2606559326 -0.4545747676 -0.2714513887  0.3969922585 -0.3923244787  0.1525796639 -0.2100140496
 [155]  0.2880724855  0.6522104738 -0.4810853880  0.1643782814 -0.0519178089 -0.0750590096  0.0749938473
 [162] -0.0158671921 -0.3427439429 -0.6939962741  0.1761566121 -0.4953142029 -0.1536033628  0.1867947805
 [169]  0.1889338949 -0.3967701607  0.3926749753 -0.1531994291 -0.4486348401  0.5475423112  0.0548735197
 [176]  0.1874783855 -0.2363127809 -0.1409053635 -0.7608906795  0.1275808795  0.1892901704 -0.2417577464
 [183] -0.1248550849  0.1416726642  0.4395488044  0.2375790140  0.0932262341  0.1553617041  0.2661357370
 [190]  0.0318018112  0.3777068269 -0.0561818521 -0.0337376111 -0.2365186218  0.0951151620 -0.2337001445
 [197]  0.0840940327 -0.2343893134  0.2328469517  0.1010421705  0.0705525996 -0.3176373858 -0.2576429488
 [204] -0.0218912060  0.0608561502 -0.2163710898 -0.1439221164 -0.4343435313  0.0843245563 -0.2538299916
 [211]  0.1023861714 -0.0363091144  0.4722826381  0.4418653728  0.3580965879 -0.3425379715 -0.2339411387
 [218]  0.2407531203 -0.0801711843 -0.3792960369 -0.3139854441  0.3495568726 -0.5298977863  0.1433841342
 [225] -0.1739834513  0.0748197156 -0.0924841762 -0.3265642241  0.1835303777 -0.0257605231  0.0361238035
 [232] -0.0625377957 -0.2854524094  0.4699955731  0.1680966999  0.5535719063  0.0079510652  0.0551148883
 [239]  0.1757863558 -0.3381144699 -0.4908186897  0.1322223494  0.0809398585  0.2701788218 -0.0296633295
 [246]  0.3274617660 -0.0873553589  0.1575819077 -0.1001690098  0.1898592845  0.3107576969  0.3500715803
 [253]  0.3846748835 -0.2499538185  0.3618736967  0.3256966960  0.0918220816 -0.1177720052 -0.2139167231
 [260]  0.1915616236  0.3699635340 -0.5672059311  0.3195926521  0.1468686978  0.6177274014  0.0088995230
 [267] -0.0904736802 -0.2320632133  0.4621299326  0.1151889650  0.0410236261  0.2226673711 -0.5925775919
 [274] -0.4952913859  0.2085902969  0.0344263280  0.2784936918  0.0649730275 -0.1839746229  0.2981821378
 [281] -0.1829087234 -0.0373399798  0.3865755902  0.1574931689  0.2908138034 -0.0189474524  0.0765465944
 [288] -0.3215040986  0.4879783781 -0.1073827994  0.2041787142  0.2960737797 -0.1319332386 -0.2312329751
 [295] -0.4237414364 -0.4413921179  0.0898402196 -0.4668047927  0.0129924673 -0.4284748799 -0.0025742557
 [302] -0.3198304072 -0.0254859903  0.4519238963  0.3020501763  0.1157383738  0.5108333850 -0.2972725673
 [309]  0.3148412167  0.0818708334  0.2037730720 -0.2658565916  0.0324487341  0.1226117700  0.6760835632
 [316]  0.0628362416 -0.3394952910 -0.7248824521 -0.2633233581 -0.7977656856 -0.2204387452  0.1509858375
 [323]  0.2361970810  0.6280269078  0.1880721895  0.3089043317 -0.0082635791 -0.0488841715 -0.3692596947
 [330]  0.2457886996  0.1428102611  0.0054892202 -0.2815163688  0.3079772020 -0.5013927266 -0.5020849853
 [337]  0.3261665223  0.3988763840  0.5366657464 -0.2428175560 -0.5501602453  0.0637128202  0.0545969099
 [344] -0.1444370615 -0.5508523059 -0.3259113709  0.3524201343 -0.1665511906 -0.2581503779  0.2306356994
 [351]  0.1141200295  0.0747441581 -0.6645909681 -0.3628283184 -0.4879971028  0.0189751692 -0.7186562948
 [358]  0.5602255101  0.2601695442 -0.1805930029  0.1260284975  0.7541809348 -0.0950270238  0.3433433990
 [365] -0.0362581097  0.1847612262  0.2219206905 -0.3735614990 -0.3331099575 -0.3927090416 -0.1146498253
 [372] -0.2482635726 -0.1195682606  0.1045264729  0.0731399327 -0.1799417410  0.3708858127 -0.2691072016
 [379]  0.2764372471  0.3131334871  0.3972271123 -0.3746595928 -0.6584909011  0.2056396829 -0.4442912463
 [386]  0.3193586883  0.3061862902  0.1896050548  0.0823473506 -0.2907122935  0.0649830542  0.1653384358
 [393]  0.4574604965 -0.2760175273  0.1303164082 -0.0939301145 -0.2386955941 -0.4092614882 -0.2856624417
 [400] -0.5761901936 -0.4336978121  0.0218025810 -0.0095492282 -0.0531729828 -0.1677422476  0.6328852704
 [407] -0.2674551231 -0.0147897490 -0.3473052924 -0.0954808814  0.0002564825 -0.1625064877 -0.0799244822
 [414] -0.1049149315  0.2947733434 -0.5974569457  0.1095709561 -0.5968779955  0.1412633623  0.2534925398
 [421] -0.1937636045 -0.1545805185 -0.2306118473 -0.1072046112 -0.0526515748  0.6488362234  0.5337767842
 [428]  0.0623457894 -0.0834984535 -0.4496666248  0.1850304258 -0.1755393752  0.1391096136  0.4704293235
 [435] -0.4534318136  0.1834241390  0.2585497567 -0.0899686623  0.5379000993  0.4542091362  0.1146041327
 [442]  0.2499231183  0.5588448495 -0.1084409773  0.0970314796 -0.0019625855  0.3385565480  0.0679885153
 [449] -0.0138437794  0.0537220604 -0.2507594415 -0.0004689633 -0.0850090795 -0.2685804902 -0.1946769435
 [456] -0.1496173652  0.2590775040  0.1164576318 -0.5876312369  0.4721938409  0.1135758135 -0.1297220411
 [463]  0.4090307302  0.1679413440 -0.6027910201  0.3356704628 -0.2264625080 -0.1015935031 -0.5066885754
 [470] -0.7192161991 -0.1642909581 -0.0560928124 -0.0330394448  0.0707639411 -0.0242684896 -0.6061100515
 [477] -0.0102006523  0.5850796801 -0.2682894093  0.3712202170 -0.6307601828 -0.3911560154  0.2515463290
 [484]  0.0866706273  0.1095252910 -0.2910621396 -0.5046462555  0.1481400395 -0.4641612688  0.4706996141
 [491] -0.1148498012  0.1931253757 -0.0170356606 -0.1687095201  0.1790835853  0.1675798195 -0.2752702159
 [498]  0.1041152353 -0.1613526679  0.2035206469  0.4056342238  0.0838041080 -0.0233274647  0.3548441654
 [505] -0.0334644701  0.0665341366 -0.1008063024 -0.4537629843  0.2917309748  0.2941924986  0.5992809093
 [512] -0.5127520893  0.4449200264 -0.7058544603  0.1383468987  0.3553150550 -0.1748206006 -0.1369841024
 [519]  0.3470522091 -0.0127640075 -0.2965040501 -0.1110432906 -0.1160755885 -0.1408033377  0.1826899210
 [526]  0.5589320862  0.4654589739  0.2391015648 -0.0002698615  0.0165337096  0.2160775165  0.0619991597
 [533]  0.0876534619  0.0905146885 -0.3503397111 -0.5813334429 -0.1927944188  0.4995541362  0.0962720515
 [540]  0.1197080141 -0.1856515316  0.6486644971 -0.2740776093  0.6412575351  0.0667634679 -0.5430863670
 [547]  0.4780765697  0.6081094197 -0.3647099496  0.0862074040  0.2045541923  0.0267716826 -0.4688895480
 [554] -0.2538178699  0.5396683706  0.6325535590  0.1617801012 -0.0246366727  0.4083008680  0.0286087681
 [561]  0.1922309165  0.0281447342 -0.3620398853 -0.0016218502 -0.3023665476 -0.4366360628 -0.1895641621
 [568] -0.1968979112  0.0648133747 -0.0899240991  0.2256392355 -0.1819533960  0.1839660116  0.3210215367
 [575] -0.2418318050 -0.0121016209  0.4998374974  0.0936565085  0.1256737225  0.3482023594  0.2260663072
 [582] -0.2363719782 -0.0917887343  0.2046162219  0.3680780572 -0.1911618789  0.1738848219  0.8207469080
 [589]  0.0836870241  0.3299563883 -0.0315909612 -0.2404702594 -0.7083496043 -0.3022051730 -0.7903013338
 [596]  0.8952228077 -0.2751615360 -0.1075833777 -0.2624184036 -0.5155523203 -0.0835313155 -0.2503794979
 [603]  0.3480494051  0.0297614743  0.2346280545 -0.6498278328  0.0848696219  0.2667877932 -0.0285258659
 [610] -0.2989989167  0.3598635926  0.4760869075 -0.8861308265 -0.2831900714  0.3507190194  0.0785014118
 [617]  0.2077356053  0.1815270898  0.3379909233 -0.4185290022  0.1477941922  0.3163139477 -0.3626089167
 [624]  0.2040930313 -0.1696047566 -0.6637784825  0.4028521740 -0.1681382020  0.1111008554 -0.3226377019
 [631] -0.1654405242  0.2731665583 -0.3813948433  0.6575250896 -0.0888802047  0.1563554689 -0.2046041199
 [638] -0.0238580915 -0.2828193319  0.2770831286  0.0971299162 -0.0629156745 -0.0500497349 -0.1529934049
 [645]  0.0945838070  0.1637606786 -0.2823901779  0.1893978417 -0.0578523331 -0.1179530930 -0.2386940238
 [652]  0.2517572096 -0.1231200071  0.0037748662 -0.0017089650 -0.0064486863 -0.4696995287 -0.2654537069
 [659] -0.4704565304  0.1951427803 -0.6838818160 -0.4625477363  0.0986919183  0.3926445431  0.1153861278
 [666]  0.1944438769  0.0989078810 -0.4954362661 -0.1194436164  0.6844394239  0.3356290573  0.0787771145
 [673]  0.0442908546 -0.1344965237  0.1779131118 -0.2862090588 -0.1878068606 -0.4878521868 -0.9062374945
 [680]  0.1390630935  0.2161686969 -0.0981637276 -0.2338204073 -0.2483354190 -0.0800561935 -0.4869847821
 [687] -0.1572328939  0.6357980178  0.0654786483  0.5021986902 -0.3660038618  0.2884404814  0.4981383203
 [694] -0.3518755420 -0.1085306737  0.5522677136 -0.3063480938  0.3710901873 -0.0210241348 -0.5149080839
 [701]  0.1831277052 -0.0882690753 -0.0844774473  0.1485522738  0.0283927210 -0.0368702852  0.3694665265
 [708]  0.5246378089 -0.1088382013  0.4533037303 -0.0823527821  0.2347360708  0.0056536385  0.0776194239
 [715]  0.5366439830  0.1615683598  0.6908066097  0.5956471625 -0.1467708036 -0.2378208781  0.2256410216
 [722] -0.2036457626  0.1617165278  0.7194169865  0.3174291267 -0.2932187482 -0.5224466157  0.0806706909
 [729]  0.3603452541  0.6174932866 -0.2937818024 -0.1131569666 -0.1110939415 -0.2404014610 -0.3312769392
 [736]  0.2124565155  0.2400493204 -0.1721962620  0.3242073782 -0.4086199935 -0.6763583252 -0.4807554632
 [743]  0.5572552007  0.3631366287 -0.7000171636  0.2077505703 -0.2655922236  0.0485441645 -0.2503857574
 [750]  0.3181274519  0.2583398512  0.0730769263 -0.5878711802  0.6080754163 -0.0804766304  0.7533024728
 [757] -0.4737685360  0.3365463984 -0.0539726583 -0.1494133512  0.1836365623 -0.1445695983 -0.0656915300
 [764] -0.3217106420 -0.0361536905  0.4119306362  0.4098645568  0.1716297726  0.5686457699  0.1466624981
 [771]  0.2836481272 -0.3018043689 -0.2319281093 -0.2351979339  0.2586364558  0.5785477107  0.1845363624
 [778]  0.0457107512  0.7209542370  0.2000576181 -0.1071293118 -0.1432834581 -0.6259731340  0.3871123575
 [785] -0.1341115953 -0.7073494906 -0.2756637787 -0.0316356909  0.1705886419  0.3456977908  0.1657918427
 [792]  0.3295463491  0.0130470789  0.3769237972 -0.4344564187  0.2900333484 -0.2650551298 -0.2236591631
 [799]  0.1227153494 -0.3299415198  0.1031855362  0.0094450562  0.2032671131  0.2262681188  0.2842965182
 [806] -0.5917164329  0.0892300184  0.0565651294  0.1668372959  0.3609549074  0.0289034103  0.2583881614
 [813] -0.4147881538 -0.1386717095 -0.1333993800  0.6057694084  0.3399958686 -0.5241408084 -0.2534049908
 [820] -0.0930744288 -0.4284115583 -0.0936639125  0.3115053789  0.1243412938  0.1467548581  0.3018683779
 [827] -0.5747445128 -0.0325576429 -0.3633818659  0.1886139786 -0.5268596704  0.0100445345 -0.1371904924
 [834]  0.3082195079 -0.2844539606  0.2603032289 -0.0548201885 -0.2644589041 -0.2118128689 -0.8069633202
 [841]  0.1448980285  0.0439263146 -0.0466513861  0.5214748955  0.4952019485  0.0068234007 -0.6554453077
 [848]  0.0783666797  0.4064299385  0.4126844267 -0.1806569482  0.6187028049  0.1257577532  0.2853396477
 [855] -0.2633131840  0.4207780670 -0.1968374560 -0.6133474033  0.0236470320 -0.0112720921  0.2964570016
 [862] -0.0307652705  0.3707034123  0.0170386317  0.3634545123  0.0345601013 -0.0017767417  0.5811326721
 [869]  0.2442708432 -0.3629493871 -0.2844936847 -0.2105664384 -0.5034232091 -0.0397069009  0.0090864724
 [876] -0.4392337289  0.0062931764 -0.6684754978  0.2821024702 -0.1156129888 -0.7044437178  0.1729863615
 [883]  0.1843288309 -0.2608107088 -0.0234480209 -0.8326788822  0.7869894151  0.0229694587 -0.7413200977
 [890] -0.4123388413  0.0790460929  0.9691476131 -0.1080214430 -0.0538929435 -0.0048351577  0.2791181835
 [897]  0.1708556266  0.4455744803  0.2448682812 -0.1558473420 -0.2406072650 -0.3367470010 -0.2110884724
 [904]  0.0163440828  0.0705061001 -0.1324782761  0.4486397952  0.7717532319 -0.5119402333  0.3957259932
 [911]  0.1884588084 -0.0719167270 -0.2157892784  0.2360439212 -0.1810568420  0.2978455506 -0.0763562765
 [918] -0.0229179869 -0.3708522802  0.0060554463 -0.1582678148  0.5712752711  0.4295241528 -0.8338155091
 [925]  0.0359683447  0.0297605129  0.0909369576  0.4020676986 -0.6568440314  0.4085961314  0.2145142805
 [932]  0.4688212699  0.1444066460  0.2616788363 -0.1167640320 -0.1399582819  0.0840591766  0.0442501876
 [939] -0.3995336742  0.2151036351  0.6864966751  0.0198995444  0.2947407970 -0.3363083133  0.0891997128
 [946]  0.0284170272  0.3799105905  0.1690968544 -0.1551730419 -0.3647470776 -0.0186755341  0.0599823787
 [953]  0.6843571670 -0.2107752022 -0.2706916415 -0.3086396004 -0.1072307936 -0.2803238324  0.1191702043
 [960] -0.2146742621 -0.6059511652  0.3457159464  0.0479883228  0.2615053050 -0.3677402618 -0.2885947221
 [967]  0.1072588517 -0.3590643272  0.2138628826 -0.2356543160  0.0329087088 -0.2210121805  0.0182753122
 [974] -0.2288562032  0.3031317545  0.1253920761 -0.2365882349 -0.3845670532 -0.4247933096 -0.5017085455
 [981]  0.1428387440 -0.4628047673  0.1629440755  0.1388499105  0.6686510383 -0.0254966176 -0.4242260711
 [988] -0.0847604381  0.0655858029  0.2880897994  0.4238525263 -0.1998969792 -0.2595439835  0.4399933004
 [995] -0.5160396161  0.2859291168 -0.4459816735 -0.2685903202  0.1587907405  0.3280046770
 [ reached getOption("max.print") -- omitted 6584 entries ]
> #matrix
> X <- cbind(DT$const, DT$x1, DT$x2, DT$x3)
> #matrix y
> y <- DT$y1
> #Now compute X’ (transpose of X)
> X_transpose <- t(X)
> #Next compute X’X . Report your result.
> XtX <- t(X) %*% X
> print(XtX)
           [,1]       [,2]       [,3]       [,4]
[1,] 7584.00000  -17.50174   44.71164  -83.68353
[2,]  -17.50174  760.48109   36.76530 1753.06360
[3,]   44.71164   36.76530 7534.93978   58.53146
[4,]  -83.68353 1753.06360   58.53146 7633.13175
> #Next compute the inverse of X’X. Report it.
> XtX_inverse <- solve(XtX)
> print(XtX_inverse)
              [,1]          [,2]          [,3]          [,4]
[1,]  1.318774e-04 -5.812830e-07 -7.920271e-07  1.585371e-06
[2,] -5.812830e-07  2.794927e-03 -8.648067e-06 -6.418371e-04
[3,] -7.920271e-07 -8.648067e-06  1.327545e-04  9.595036e-07
[4,]  1.585371e-06 -6.418371e-04  9.595036e-07  2.784254e-04
> #Next compute X’y. Report
> Xty <- t(X) %*% y
> print(Xty)
          [,1]
[1,] 16165.510
[2,]  1138.412
[3,] 10390.491
[4,]  4498.830
> #Lastly multiply the inverse of X’X with X’y. Report your result. What is this?
> beta_hat <- XtX_inverse %*% Xty
> print(beta_hat)
          [,1]
[1,] 2.1301059
[2,] 0.1950077
[3,] 1.3610525
[4,] 0.5575116
> #Compare
> #Regress y1 on x1, x2, and x3 in a linear model.
> lm_model <- lm(y ~ x1 + x2 + x3, data = DT)
> print(summary(lm_model)$coefficients)
             Estimate Std. Error   t value      Pr(>|t|)
(Intercept) 2.1301059 0.03638552 58.542688  0.000000e+00
x1          0.1950077 0.16750533  1.164188  2.443844e-01
x2          1.3610525 0.03650632 37.282657 1.699169e-279
x3          0.5575116 0.05286860 10.545231  8.061875e-26
> #Divide XtX by n (number of observations) and compare it to cov(DT), comment.
> n <- nrow(DT)
> XtX_normalized <- XtX / n
> cat("\nX'X divided by n:\n")

X'X divided by n:
> print(XtX_normalized)
             [,1]         [,2]        [,3]         [,4]
[1,]  1.000000000 -0.002307718 0.005895523 -0.011034220
[2,] -0.002307718  0.100274406 0.004847745  0.231152901
[3,]  0.005895523  0.004847745 0.993531089  0.007717756
[4,] -0.011034220  0.231152901 0.007717756  1.006478342
> cat("\nCovariance matrix of DT:\n")

Covariance matrix of DT:
> print(cov(DT))
               y1 const           x1            x2           x3          eps1         eps2
y1    12.25690892     0  0.155046477  1.3576667372  0.616801283  0.0360582511  -0.64864934
const  0.00000000     0  0.000000000  0.0000000000  0.000000000  0.0000000000   0.00000000
x1     0.15504648     0  0.100282303  0.0048619913  0.231157917 -0.0012834818   0.02016097
x2     1.35766674     0  0.004861991  0.9936273478  0.007783835 -0.0003215527  -0.05180781
x3     0.61680128     0  0.231157917  0.0077838346  1.006489300  0.0092743688  -0.10210255
eps1   0.03605825     0 -0.001283482 -0.0003215527  0.009274369  1.9359181599   0.23233064
eps2  -0.64864934     0  0.020160966 -0.0518078121 -0.102102549  0.2323306434 195.90819684


> #IV – Exercise
> library(data.table)
> library(lmtest)
> library(ivreg) 
> library(MASS)
> data <- read.table("IV_Data.RData")
> # Dependent variable
> y <- data$y4  
> # Endogenous independent variable
> x1 <- data$x1  
> # Potentially endogenous independent variable
> x2 <- data$x2 
> #instrumental variables
> instruments <- data[, c("z1", "z2", "z3", "z4")]
> # OLS Regression
> ols_model <- lm(y4 ~ x1 + x2, data = data)
> summary(ols_model)  # View OLS regression summary

Call:
lm(formula = y4 ~ x1 + x2, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.9523 -0.6623  0.0039  0.6689  4.0383 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 0.491679   0.007577   64.89   <2e-16 ***
x1          2.201800   0.007620  288.96   <2e-16 ***
x2          1.737673   0.007563  229.75   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.005 on 17581 degrees of freedom
Multiple R-squared:  0.8987,	Adjusted R-squared:  0.8987 
F-statistic: 7.797e+04 on 2 and 17581 DF,  p-value: < 2.2e-16

> # Calculate expected bias (assuming eps is in the last column of Var-Cov matrix)
> # Correlation between x1 and eps
> bias_x1 <- cor(data[, 1:2], data[, ncol(data)])[2, 1]  
> # Correlation between x2 and eps
> bias_x2 <- cor(data[, 2:3], data[, ncol(data)])[2, 1]  
Warning message:
In cor(data[, 2:3], data[, ncol(data)]) : the standard deviation is zero
> # Identify potentially endogenous instrument (check correlation with eps)
> corr_instruments_eps <- cor(instruments, data[, ncol(data)])
> # Analyze correlations between instruments and x1 (weak/irrelevant check)
> corr_instruments_x1 <- cor(instruments, x1)
> # Placeholder - Replace with your actual Var-Cov matrix data
> # (This part simulates example correlations for demonstration purposes)
> cor_matrix <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0,
+                                0, 1, 0.12, 0.5, 0, 0.2, 0.01, 0.6,
+                                0, 0.12, 1, 0.4, 0, 0, 0.001, 0.02,
+                                0, 0.5, 0.4, 1, 0.6, 0, 0, 0.6,
+                                0, 0, 0, 0, 1, 0.4, 0, 0,
+                                0, 0.2, 0, 0, 0.4, 1, 0, 0,
+                                0, 0.01, 0.001, 0, 0, 0, 1, 0,
+                                0, 0.6, 0.02, 0.6, 0, 0, 0, 1), 
+                              nrow = 8, byrow = TRUE)
> # Print example correlations (replace with actual calculations)
> cat("Correlations between instruments and eps:\n")
Correlations between instruments and eps:
> print(corr_instruments_eps)
           [,1]
z1 -0.007903026
z2 -0.005156987
z3  0.004509724
z4  1.000000000
> cat("\nCorrelations between instruments and x1:\n")

Correlations between instruments and x1:
> print(corr_instruments_x1)
           [,1]
z1  0.506388695
z2 -0.004625618
z3  0.183866592
z4  0.016994222
> # Example logic for identifying a valid instrument (replace with actual analysis)
> # Assuming Z2 has a strong correlation with x1 and a weak correlation with eps based on the example_cor_matrix
> potential_valid_instrument <- "z2"
> # IV Regression using the potential valid instrument
> iv_model <- ivreg(y4 ~ x1 | z1 + x2, data = data)
> summary(iv_model)  # View IV regression summary

Call:
ivreg(formula = y4 ~ x1 | z1 + x2, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-8.356541 -1.425083 -0.007689  1.417224  9.537300 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.48119    0.01588   30.31   <2e-16 ***
x1           3.05133    0.03083   98.97   <2e-16 ***

Diagnostic tests:
                   df1   df2 statistic p-value    
Weak instruments     2 17581      3149  <2e-16 ***
Wu-Hausman           1 17581       633  <2e-16 ***
Sargan               1    NA     11467  <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.105 on 17582 degrees of freedom
Multiple R-Squared: 0.5551,	Adjusted R-squared: 0.5551 
Wald test:  9794 on 1 and 17582 DF,  p-value: < 2.2e-16 

> #regression first stage
> first_stage <- lm(x1 ~ z1, data = data)
> #predicted values of x1
> x1_hat <- predict(first_stage, newdata = data)
> #regression second stage
> second_stage <- lm(y4 ~ x1_hat, data = data)
> summary(second_stage)

Call:
lm(formula = y4 ~ x1_hat, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.9861 -1.7301 -0.0156  1.7459 11.9990 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.48305    0.01938   24.92   <2e-16 ***
x1_hat       3.60786    0.03817   94.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.57 on 17582 degrees of freedom
Multiple R-squared:  0.3369,	Adjusted R-squared:  0.3369 
F-statistic:  8932 on 1 and 17582 DF,  p-value: < 2.2e-16

> #convert to dt
> data_dt <- data.table(data)
> # first Stage Regression 
> first_stage_dt <- lm(x1 ~ z1, data = data_dt)
> # predicted values of x1
> x1_hat_dt <- predict(first_stage_dt, newdata = data_dt)
> # z-matrix construction
> Z_matrix <- data.matrix(data_dt[, z1])
> # Second Stage Regression (matrix approach)
> X_matrix <- data.matrix(x1_hat_dt)
> y_vector <- data_dt[, y4]
> #first-stage residuals
> first_stage_residuals <- residuals(first_stage_dt)
> #squared first-stage residuals
> squared_residuals <- first_stage_residuals^2
> # weights inversely proportional to squared residuals
> W2 <- diag(1 / squared_residuals)
> # MM-IV Estimator (assuming W2 is the diagonal weight matrix based on first-stage residuals)
> beta_mmiv <- solve(t(X_matrix) %*% W2 %*% X_matrix) %*% (t(X_matrix) %*% y_vector)
> print(beta_mmiv)
             [,1]
[1,] 0.0006609032
